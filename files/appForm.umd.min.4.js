(("undefined"!==typeof self?self:this)["webpackJsonpappForm"]=("undefined"!==typeof self?self:this)["webpackJsonpappForm"]||[]).push([[4],{"0690":function(t,e,i){"use strict";i.r(e);var s=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",[i("b-container",{staticClass:"bv-example-row bg-light p-4",attrs:{fluid:"lg"}},[i("div",{attrs:{checkUid:t.checkUid}},[i("h5",{staticClass:"titre mb-3 shadow-sm p-2"},[t._v(" Mes devis : "),i("span",{staticClass:"form-title"},[t._v(t._s(t.form.name))])])]),i("b-row",{attrs:{"align-h":"center"}},[i("b-col",{attrs:{cols:"12"}},[i("list-table",{attrs:{liste_fields_check:t.ListeFieldsCheck,liste_fields_display:t.ListeFieldsDisplay,totalRows:t.totalRows,isBusy:t.isBusy,perPage:t.perPage},on:{"ev-change-pagination":t.ChangePagination}})],1)],1)],1)],1)},a=[],n=i("5530"),r=(i("b0c0"),i("a434"),i("f158")),o=i("2f62"),l=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",[i("b-table",{staticClass:"traitement",attrs:{items:t.traitementFormItemsDisplay,fields:t.liste_fields_display,outlined:!0,hover:!0,"head-variant":"dark",responsive:"","sticky-header":!0,trigger_perfom:t.trigger_perfom,busy:t.isBusy},scopedSlots:t._u([{key:"cell()",fn:function(e){return[i("div",[e.item[e.field.key]&&void 0===e.item[e.field.key].type?i("div",["status"===e.field.key?i("div",[i("h5",{staticClass:"status"},[t._v(" "+t._s(1==e.item.status?"Sauvegardé":"Devis en attente de rappel")+" ")])]):"uid"===e.field.key?i("div",["0"!==e.item.uid?i("div",[e.item.user?i("ul",{staticClass:"m-0 p-0 pl-2"},t._l(t.getInfoUser(e.item.user),(function(e,s){return i("li",{key:s},[t._v(" "+t._s(e.text)+" ")])})),0):t._e()]):i("div",[t._v("Anonyme")])]):i("div",[t._v(" "+t._s(e.value)+" ")])]):e.item[e.field.key]?i("div",[i(t.getTemplatesFiles(e.item[e.field.key].type),{tag:"component",staticClass:"content-field",attrs:{field:e.item[e.field.key]}})],1):i("div",["action"===e.field.key?i("div",[i("b-button-group",{},[i("b-button",{attrs:{variant:"outline-primary"},on:{click:function(i){return t.getValideStepe(e.index)}}},[t._v(" voir mon devis ")]),t.$store.state.mode?i("b-button",{attrs:{variant:"outline-success"},on:{click:function(i){return t.showResult(e.item)}}},[t._v(" Editer ")]):t._e(),t.$store.state.mode?i("b-button",{attrs:{variant:"outline-warning"},on:{click:function(i){return t.formTraiter(e.item)}}},[t._v(" Traiter ")]):t._e()],1)],1):t._e()])])]}},{key:"table-busy",fn:function(){return[i("div",{staticClass:"text-center text-danger my-2"},[i("b-spinner",{staticClass:"align-middle"}),i("strong",[t._v("chargements des devis...")])],1)]},proxy:!0}])}),t.totalRows>20?i("b-pagination",{staticClass:"my-0",attrs:{"total-rows":t.totalRows,"per-page":t.perPage,align:"fill",size:"sm"},on:{change:t.changePagination},model:{value:t.currentPage,callback:function(e){t.currentPage=e},expression:"currentPage"}}):t._e(),i("b-modal",{ref:"modal",staticClass:"super-hover",attrs:{id:"modal--closing",size:"lg",title:"Résultat du formulaire",scrollable:"",cancelTitle:"Quitter",okTitle:"Me rappeler"},scopedSlots:t._u([{key:"modal-footer",fn:function(){return[i("div",{staticClass:"d-flex"},[i("div",{staticClass:"w-100"},[i("b-button",{staticClass:"mr-3",attrs:{variant:"primary",size:"sm"},on:{click:function(e){return t.$bvModal.hide("modal--closing")}}},[t._v(" Quitter ")]),"1"!==t.currentDevis.status&&1!==t.currentDevis.status||t.currentDevis.uid!==t.$store.state.uid?t._e():i("b-button",{attrs:{variant:"primary",size:"sm"},on:{click:function(e){return t.updateStatus()}}},[t._v(" Me rappeler ")])],1)])]},proxy:!0}]),model:{value:t.showModal,callback:function(e){t.showModal=e},expression:"showModal"}},[t.traitementFormItems.length?i("b-row",{attrs:{"align-h":"center"}},t._l(t.validSteps2,(function(e,s){return i("b-col",{key:s,staticClass:"mb-4",attrs:{sm:"12"}},[void 0!==e?i("b-card",{staticClass:"mb-1",attrs:{"no-body":""}},[i("b-card-header",{staticClass:"p-1",attrs:{"header-tag":"header",role:"tab"}},[i("b-button",{attrs:{block:"",variant:"dark",disabled:""}},[t._v(" "+t._s(e.info.title)+" ")])],1),i("b-collapse",{attrs:{id:"accordion-option",accordion:"my-accordion",role:"tabpanel",visible:""}},[i("b-card-body",{staticClass:"p-2"},[i("b-row",{staticClass:"d-flex flex-wrap"},t._l(e.fields,(function(e,s){return i("b-col",{key:s,attrs:{cols:"12"}},[void 0===e.status||e.status?i("type-displays",{staticClass:"mb-2",attrs:{field:e}}):i("div",[i("pre",{staticClass:"d-none"},[t._v("                      "+t._s(e.name)+"\n                    ")])])],1)})),1)],1)],1)],1):t._e()],1)})),1):t._e()],1)],1)},c=[],u=(i("a9e3"),i("e260"),i("d3b7"),i("e6cf"),i("3ca3"),i("ddb0"),i("caad"),i("2532"),i("fd71")),d=i("5784"),f=i("e674"),p={name:"Listesfomes",props:{liste_fields_check:{type:Array,default:function(){return[]}},liste_fields_display:{type:Array,default:function(){return[]}},totalRows:{type:Number,required:!0},isBusy:{type:Boolean,required:!0},perPage:{type:Number,required:!0}},components:{typeDisplays:function(){return i.e(5).then(i.bind(null,"5b90"))}},data:function(){return{showModal:!1,validSteps2:[],traitementFormItemsDisplay:[],currentDataId:null,currentDevis:{},currentPage:1}},mounted:function(){},watch:{},computed:Object(n["a"])(Object(n["a"])(Object(n["a"])({},Object(o["c"])(["items","CachesUser"])),Object(o["b"])(["traitementFormItems"])),{},{trigger_perfom:function(){return this.traitementFormItems.length?(this.getTraitementFormItems(),this.traitementFormItems.length):""}}),methods:{getTraitementFormItems:function(){for(var t in console.log("traitementFormItems : ",this.traitementFormItemsDisplay),this.traitementFormItemsDisplay=[],this.traitementFormItems){var e=this.traitementFormItems[t],i={id:e.id,status:e.status,created:e.created,price:e.price,uid:e.uid,user:{}};for(var s in this.getUser(e.uid,i),e.datas){var a=e.datas[s];for(var n in a.fields){var r=a.fields[n];this.liste_fields_check.includes(r.name)&&(i[r.name]=r)}}this.traitementFormItemsDisplay.push(i)}},getTemplatesFiles:function(t){return d["a"].getTemplatesFiles(t)},getValideStepe:function(t){var e=this;this.showModal=!this.showModal,this.validSteps2=[],this.currentDataId=this.traitementFormItems[t].id,this.currentDevis=this.traitementFormItems[t];var i=this.traitementFormItems[t].datas;function s(t){var a=function(t){return new Promise((function(e){u["a"].selectNextState(i,t).then((function(t){e(t)}))}))};a(t).then((function(t){t&&t<200&&(e.validSteps2.push(i[t]),s(t))}))}this.validSteps2.push(i[0]),s(0)},showResult:function(t){console.log("id",t)},formTraiter:function(t){var e="";e="0"==t.status?"1":"0",this.$bvModal.msgBoxConfirm("Confirmez-vous avoir l'action",{title:"Alerte",size:"sm",buttonSize:"sm",okVariant:"success",okTitle:"Traiter",cancelTitle:"Annuler",footerClass:"p-2",hideHeaderClose:!1,centered:!0}).then((function(i){i&&(console.log("Refus : ",t),r["a"].deleteFormTraitement(t.id,e).then((function(){window.location.reload()})))}))},getUser:function(t){var e=this,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.CachesUser["uid"+t]?i.user=this.CachesUser["uid"+t]:f["c"].getUser(t).then((function(s){i.user=s,e.$store.dispatch("setCachesUser",{uid:t,user:s})}))},getInfoUser:function(t){var e=[],i=["mail","name"];return i.forEach((function(i){t[i]&&e.push({text:t[i][0].value})})),e},updateStatus:function(){if(this.currentDataId){var t={table:"appformmanager_datas",fields:{status:0},action:"update",where:[{column:"id",value:this.currentDataId}]};r["a"].saveForm([t],this.$store.state.mode).then((function(){r["a"].modalSuccess("Vous serrez rappellé par un specialiste dans les plus bref delais.",{title:"Status du devis mise à jour",footerClass:"d-none"}),setTimeout((function(){window.location.reload()}),3e3)}))}},changePagination:function(t){this.$emit("ev-change-pagination",t)}}},m=p,h=(i("d77f"),i("2877")),v=Object(h["a"])(m,l,c,!1,null,null,null),b=v.exports,g={components:{ListTable:b},props:{id:{type:String,required:!0}},data:function(){return{totalRows:0,isBusy:!1,perPage:20}},watch:{stepsId:function(){this.datasBdOrLocalStorage()}},mounted:function(){},computed:Object(n["a"])(Object(n["a"])(Object(n["a"])({},Object(o["c"])(["traitementId"])),Object(o["b"])(["traitementFormItems","form","uid"])),{},{ListeFieldsDisplay:function(){var t=[{label:"Date",key:"created",formatter:function(t){return r["a"].getMysqlDateToFrench(t)}},{label:"Prix",key:"price"},{label:"Que souhaitez vous faire",key:"action",stickyColumn:!0}];for(var e in this.form.forms){var i=this.form.forms[e];for(var s in i.fields){var a=i.fields[s];a.display_field&&t.push({label:a.label,key:a.name})}}return t},ListeFieldsCheck:function(){var t=[];for(var e in this.ListeFieldsDisplay)t.push(this.ListeFieldsDisplay[e].key);return t},checkUid:function(){return!!this.uid&&(this.loadDatas(),this.getTotalRows(),!0)}}),methods:{deleteSteps:function(t){var e=this.$store.state.allStepsDatas,i=e.indexOf(this.formDatas);this.$emit("index-to-delete",i),console.log("de",t);for(var s=e.length-1;s>=0;s--)s===i&&(e.splice(s,1),console.log("iiippp"))},saveToLocal:function(){r["a"].prepareDatasToSave(this.form).then((function(t){r["a"].saveForm(t).then((function(){}))}))},resetValue:function(){this.$store.getters.formDatas.selected="",this.$store.getters.formDatas.value=[],console.log("prev")},resetModal:function(){},handleOk:function(t){t.preventDefault(),this.handleSubmit()},handleSubmit:function(t){var e=this;t.preventDefault(),this.demo=!0,this.$nextTick((function(){e.$bvModal.hide("modal-prevent-closing")}))},loadDatas:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;this.isBusy=!0;var i=null;e&&(i=(e-1)*this.perPage),this.$store.dispatch("loadTraitementDatas",{id:this.id,pagination:i,uid:this.uid}).then((function(){t.$store.dispatch("setTraitId",t.id),t.$store.dispatch("setFormId",t.id),t.isBusy=!1}))},ChangePagination:function(t){this.loadDatas(t)},getTotalRows:function(){var t=this,e="select count(*) as nombres from `appformmanager_datas` where `appformmanager_forms` = "+this.id+" and `uid` = "+this.uid;r["a"].getData(e).then((function(e){e.data[0]&&e.data[0].nombres&&(t.totalRows=parseInt(e.data[0].nombres)),console.log("resp[0].nombres : ",e.data[0])}))}}},_=g,y=(i("b49c"),Object(h["a"])(_,s,a,!1,null,null,null));e["default"]=y.exports},5784:function(t,e,i){"use strict";var s=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",[t._v(" "+t._s(t.value)+" ")])},a=[],n={name:"codePostal",props:{field:{type:Object,required:!0}},components:{},data:function(){return{}},mounted:function(){},watch:{},computed:{value:function(){return this.field.value&&this.field.value.text?this.field.value.text:""}},methods:{}},r=n,o=i("2877"),l=Object(o["a"])(r,s,a,!1,null,"6f4b6259",null),c=l.exports,u=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",[t._v(" "+t._s(t.field.value)+" "),i("pre",{staticClass:"d-none"},[t._v("    "+t._s(t.field)+"\n  ")])])},d=[],f={name:"defaultRender.vue",props:{field:{type:Object,required:!0}},components:{},data:function(){return{}},mounted:function(){},watch:{},computed:{},methods:{}},p=f,m=Object(o["a"])(p,u,d,!1,null,"0c33df07",null),h=m.exports,v=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",[i("ul",{staticClass:"m-0 p-0 pl-4"},t._l(t.getValue,(function(e,s){return i("li",{key:s},[t._v(" "+t._s(e)+" ")])})),0)])},b=[],g=i("53ca"),_={name:"select",props:{field:{type:Object,required:!0}},components:{},data:function(){return{}},mounted:function(){},watch:{},computed:{getValue:function(){var t=[];if(this.field.value){var e=Object(g["a"])(this.field.value);if("object"===e)for(var i in this.field.value)t.push(this.getTextInOptions(this.field.value[i]));else t.push(this.getTextInOptions(this.field.value))}return t}},methods:{getTextInOptions:function(t){for(var e in this.field.options)if(this.field.options[e].value===t)return this.field.options[e].text}}},y=_,k=Object(o["a"])(y,v,b,!1,null,"0b966228",null),I=k.exports,w=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",[i("strong",[t._v(t._s(t.price)+" €")])])},C=[],x={name:"recapitulatif",props:{field:{type:Object,required:!0}},components:{},data:function(){return{}},mounted:function(){},watch:{},computed:{price:function(){return this.field.prix&&this.field.prix.cout?this.field.prix.cout:0}},methods:{}},F=x,D=Object(o["a"])(F,w,C,!1,null,"65058f0a",null),O=D.exports,T=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",[i("ul",{staticClass:"m-0 p-0 pl-4"},t._l(t.field.value,(function(e,s){return i("li",{key:s,staticClass:"d-flex"},[i("span",{staticClass:"label"},[t._v(" "+t._s(e.label)+" : ")]),i("strong",{staticClass:"value"},[t._v(" "+t._s(e.value)+" ")])])})),0)])},S=[],j={name:"userlogin",props:{field:{type:Object,required:!0}},components:{},data:function(){return{}},mounted:function(){},watch:{},computed:{},methods:{}},$=j,E=Object(o["a"])($,T,S,!1,null,"955200dc",null),N=E.exports,P=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",[i("ul",{staticClass:"m-0 p-0 pl-4"},t._l(t.value,(function(e,s){return i("li",{key:s},[i("a",{attrs:{href:e.url,download:e.filename}},[t._v(t._s(e.filename))])])})),0)])},M=[],R={name:"file",props:{field:{type:Object,required:!0}},components:{},data:function(){return{}},mounted:function(){},watch:{},computed:{value:function(){return this.field.value.length?this.field.value:[]}},methods:{}},A=R,U=Object(o["a"])(A,P,M,!1,null,"a02ae002",null),L=U.exports;e["a"]={getTemplatesFiles:function(t){var e=h;switch(t){case"codepostal":e=c;break;case"select":e=I;break;case"checkbox":e=I;break;case"radio":e=I;break;case"recapitulatif":e=O;break;case"userlogin":e=N;break;case"file":e=L;break}return e}}},5899:function(t,e){t.exports="\t\n\v\f\r                　\u2028\u2029\ufeff"},"58a8":function(t,e,i){var s=i("1d80"),a=i("5899"),n="["+a+"]",r=RegExp("^"+n+n+"*"),o=RegExp(n+n+"*$"),l=function(t){return function(e){var i=String(s(e));return 1&t&&(i=i.replace(r,"")),2&t&&(i=i.replace(o,"")),i}};t.exports={start:l(1),end:l(2),trim:l(3)}},"5e76":function(t,e,i){},7156:function(t,e,i){var s=i("861d"),a=i("d2bb");t.exports=function(t,e,i){var n,r;return a&&"function"==typeof(n=e.constructor)&&n!==i&&s(r=n.prototype)&&r!==i.prototype&&a(t,r),t}},"99b1":function(t,e,i){},a9e3:function(t,e,i){"use strict";var s=i("83ab"),a=i("da84"),n=i("94ca"),r=i("6eeb"),o=i("5135"),l=i("c6b6"),c=i("7156"),u=i("c04e"),d=i("d039"),f=i("7c73"),p=i("241c").f,m=i("06cf").f,h=i("9bf2").f,v=i("58a8").trim,b="Number",g=a[b],_=g.prototype,y=l(f(_))==b,k=function(t){var e,i,s,a,n,r,o,l,c=u(t,!1);if("string"==typeof c&&c.length>2)if(c=v(c),e=c.charCodeAt(0),43===e||45===e){if(i=c.charCodeAt(2),88===i||120===i)return NaN}else if(48===e){switch(c.charCodeAt(1)){case 66:case 98:s=2,a=49;break;case 79:case 111:s=8,a=55;break;default:return+c}for(n=c.slice(2),r=n.length,o=0;o<r;o++)if(l=n.charCodeAt(o),l<48||l>a)return NaN;return parseInt(n,s)}return+c};if(n(b,!g(" 0o1")||!g("0b1")||g("+0x1"))){for(var I,w=function(t){var e=arguments.length<1?0:t,i=this;return i instanceof w&&(y?d((function(){_.valueOf.call(i)})):l(i)!=b)?c(new g(k(e)),i,w):k(e)},C=s?p(g):"MAX_VALUE,MIN_VALUE,NaN,NEGATIVE_INFINITY,POSITIVE_INFINITY,EPSILON,isFinite,isInteger,isNaN,isSafeInteger,MAX_SAFE_INTEGER,MIN_SAFE_INTEGER,parseFloat,parseInt,isInteger,fromString,range".split(","),x=0;C.length>x;x++)o(g,I=C[x])&&!o(w,I)&&h(w,I,m(g,I));w.prototype=_,_.constructor=w,r(a,b,w)}},b49c:function(t,e,i){"use strict";i("5e76")},d77f:function(t,e,i){"use strict";i("99b1")}}]);
//# sourceMappingURL=appForm.umd.min.4.js.map